buildscript {
  repositories {
    maven {
      url 'https://plugins.gradle.org/m2/'
    }
  }
  dependencies {
    classpath 'me.champeau.gradle:jmh-gradle-plugin:0.3.1'
    classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
  }
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'com.github.johnrengelman.shadow'
apply plugin: "me.champeau.gradle.jmh"

sourceCompatibility = 1.8
version = '1.0'

jar {
    manifest {
        attributes 'Implementation-Title': 'Gradle Quickstart',
                   'Implementation-Version': version
    }
}

sourceSets {
    jmh {
        java { srcDir 'src/jmh/java' }
        resources { srcDir 'src/jmh/resources' }
    }
}

repositories {
    mavenCentral()
}

dependencies {
    jmh 'commons-io:commons-io:2.4'

    jmh 'org.openjdk.jmh:jmh-core:1.12'
    jmh 'org.openjdk.jmh:jmh-generator-annprocess:1.12'
}

jmh {
    jmhVersion = '1.12'
    warmupIterations = 5
    iterations = 20
    fork = 2
    failOnError = true
    
    duplicateClassesStrategy = 'warn'
}

jmhJar {
    destinationDir = file("${buildDir}/libs")
    exclude 'LICENSE'
}

task wrapper(type: Wrapper) {
    gradleVersion = '3.5.1'
}

